<!doctype html>
<html lang="de" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>BALKO ‚Äì Marktplatz</title>
  
  <style>
    /* --- iOS DESIGN SYSTEM --- */
    :root {
      /* LIGHT MODE */
      --bg-body: #F2F2F7;       
      --bg-card: #FFFFFF;
      --bg-input: #E5E5EA;      
      --text-primary: #000000;
      --text-secondary: #8E8E93;
      --separator: #C6C6C8;     
      --accent: #007AFF;        
      --danger: #FF3B30;        
      --success: #34C759;       
      
      --radius-l: 20px;         
      --radius-m: 14px;         
      
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
      --font: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      
      --nav-height: 60px;
      --max-width: 960px;       
    }

    [data-theme="dark"] {
      /* DARK MODE */
      --bg-body: #000000;
      --bg-card: #1C1C1E;       
      --bg-input: #2C2C2E;
      --text-primary: #FFFFFF;
      --text-secondary: #98989D;
      --separator: #38383A;
      --accent: #0A84FF;
      --shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    
    body {
      background-color: var(--bg-body);
      color: var(--text-primary);
      font-family: var(--font);
      -webkit-font-smoothing: antialiased;
      padding-bottom: 100px;
      transition: background-color 0.3s ease;
    }

    button, input, select, textarea { font-family: inherit; border: none; outline: none; }
    a { text-decoration: none; color: inherit; cursor: pointer; }
    .wrap { max-width: var(--max-width); margin: 0 auto; padding: 0 20px; }
    .hidden { display: none !important; }

    /* --- NAVIGATION --- */
    .navbar {
      position: sticky; top: 0; z-index: 1000;
      height: var(--nav-height);
      background: rgba(255, 255, 255, 0.85); 
      backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      border-bottom: 0.5px solid var(--separator);
      display: flex; align-items: center; justify-content: center;
    }
    [data-theme="dark"] .navbar { background: rgba(28, 28, 30, 0.85); }

    .nav-inner { width: 100%; display: flex; justify-content: space-between; align-items: center; }
    .logo { font-weight: 700; font-size: 20px; letter-spacing: -0.5px; color: var(--text-primary); }
    .logo span { color: var(--accent); }

    /* Controls (Lang + Theme) */
    .nav-controls { display: flex; gap: 10px; align-items: center; }

    .lang-select {
      background: var(--bg-input); color: var(--text-primary);
      font-size: 13px; font-weight: 600; padding: 0 10px; height: 36px;
      border-radius: 18px; cursor: pointer; appearance: none;
      text-align: center; border: 1px solid transparent;
    }
    .lang-select:focus { border-color: var(--accent); }

    .theme-toggle {
      width: 36px; height: 36px; border-radius: 50%;
      background: var(--bg-input); color: var(--text-primary);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 18px; transition: 0.2s;
    }
    .theme-toggle:active { transform: scale(0.92); }

    /* --- DESKTOP NAV --- */
    @media (min-width: 769px) {
      .tab-bar { display: none; }
      .desktop-links { display: flex; gap: 30px; }
      .d-link { font-size: 15px; font-weight: 500; color: var(--text-secondary); transition: 0.2s; cursor: pointer;}
      .d-link:hover, .d-link.active { color: var(--text-primary); }
    }
    @media (max-width: 768px) { .desktop-links { display: none; } }

    /* --- COMPONENTS --- */
    .ios-input-group { margin-bottom: 20px; }
    .ios-label {
      display: block; font-size: 12px; text-transform: uppercase; 
      color: var(--text-secondary); margin-bottom: 8px; margin-left: 4px; letter-spacing: 0.5px;
    }
    .ios-input {
      width: 100%; height: 50px; padding: 0 16px;
      background: var(--bg-card); color: var(--text-primary);
      border-radius: var(--radius-m); font-size: 17px;
      transition: 0.2s;
    }
    .ios-input:focus { box-shadow: 0 0 0 2px var(--accent); }
    textarea.ios-input { height: auto; padding-top: 14px; min-height: 120px; resize: none; }
    
    select.ios-input {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%238E8E93' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat; background-position: right 16px center; background-size: 16px;
    }

    .ios-card {
      background: var(--bg-card); border-radius: var(--radius-l);
      padding: 24px; box-shadow: var(--shadow); margin-bottom: 24px;
      position: relative; overflow: hidden;
    }

    .ios-btn {
      width: 100%; height: 52px;
      background: var(--accent); color: #fff;
      font-size: 17px; font-weight: 600;
      border-radius: var(--radius-m);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; transition: transform 0.1s, opacity 0.2s;
    }
    .ios-btn:active { transform: scale(0.98); opacity: 0.9; }
    .ios-btn.secondary { background: var(--bg-input); color: var(--text-primary); }

    /* --- LAYOUTS --- */
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
    @media (max-width: 600px) { .grid-4 { grid-template-columns: 1fr 1fr; } }

    /* --- VIEW: MARKET --- */
    .market-header { margin: 30px 0 20px 0; text-align: center; }
    .market-title { font-size: 32px; font-weight: 700; margin-bottom: 8px; }
    .market-subtitle { color: var(--text-secondary); font-size: 17px; }

    .search-wrapper { position: relative; margin-bottom: 24px; }
    .search-input { background: var(--bg-input); border-radius: 12px; padding-left: 44px; }
    .search-icon { position: absolute; left: 14px; top: 16px; color: var(--text-secondary); font-size: 18px; }

    .adv-filter-box {
      margin-top: 16px; padding: 16px; background: rgba(0,122,255,0.05); 
      border-radius: var(--radius-m); display: none;
    }
    .adv-filter-box.show { display: block; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from{opacity:0; transform:translateY(-5px)} to{opacity:1; transform:translateY(0)} }

    .listing-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 30px;
    }
    @media (min-width: 600px) { .listing-grid { grid-template-columns: repeat(3, 1fr); } }
    @media (min-width: 900px) { .listing-grid { grid-template-columns: repeat(4, 1fr); } }

    .empty-state {
      grid-column: 1 / -1; padding: 80px 0; text-align: center; color: var(--text-secondary);
    }
    .empty-icon { font-size: 48px; margin-bottom: 16px; opacity: 0.3; }

    /* --- VIEW: SELL --- */
    .upload-box {
      aspect-ratio: 1; background: var(--bg-input); border-radius: var(--radius-m);
      display: flex; align-items: center; justify-content: center;
      font-size: 24px; color: var(--text-secondary); cursor: pointer;
    }
    .upload-box.main { border: 2px solid var(--accent); color: var(--accent); background: rgba(0, 122, 255, 0.05); }

    /* --- VIEW: PROFILE --- */
    .profile-header { text-align: center; padding: 30px 0; }
    .avatar-circle {
      width: 100px; height: 100px; border-radius: 50%;
      background: var(--bg-input); margin: 0 auto 16px;
      display: flex; align-items: center; justify-content: center;
      font-size: 40px; border: 1px solid var(--separator);
    }
    .list-group {
      background: var(--bg-card); border-radius: var(--radius-l); overflow: hidden; margin-bottom: 24px;
    }
    .list-item {
      padding: 16px 20px; border-bottom: 0.5px solid var(--separator);
      display: flex; align-items: center; justify-content: space-between; cursor: pointer; font-size: 16px;
    }
    .list-item:last-child { border-bottom: none; }
    .list-item:active { background: var(--bg-input); }
    .list-icon { margin-right: 12px; width: 24px; text-align: center; }
    .chevron { color: var(--text-secondary); font-size: 14px; font-weight: 700; }

    /* --- MOBILE TAB BAR --- */
    .tab-bar {
      position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000;
      height: 84px; background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      border-top: 0.5px solid var(--separator);
      display: grid; grid-template-columns: 1fr 1fr 1fr;
      padding-bottom: 20px;
    }
    [data-theme="dark"] .tab-bar { background: rgba(28, 28, 30, 0.9); }
  </style>
</head>
<body>

  <nav class="navbar">
    <div class="wrap nav-inner">
      <div class="logo" onclick="app.nav('market')">BALKO<span>.</span></div>
      
      <div class="desktop-links">
        <div class="d-link active" id="d-market" onclick="app.nav('market')" data-i18n="nav_market">Entdecken</div>
        <div class="d-link" id="d-sell" onclick="app.nav('sell')" data-i18n="nav_sell">Verkaufen</div>
        <div class="d-link" id="d-profile" onclick="app.nav('profile')" data-i18n="nav_profile">Profil</div>
      </div>

      <div class="nav-controls">
        <select class="lang-select" id="lang-switcher" onchange="app.setLanguage(this.value)">
          <option value="de">DE</option>
          <option value="en">EN</option>
          <option value="sq">SQ</option>
          <option value="sr">SR</option>
          <option value="mk">MK</option>
        </select>
        
        <div class="theme-toggle" onclick="app.toggleTheme()">
          <span id="theme-icon">üåô</span>
        </div>
      </div>
    </div>
  </nav>

  <main class="wrap">
    
    <section id="view-market">
      <div class="market-header">
        <div class="market-title" data-i18n="market_title">Marktplatz</div>
        <div class="market-subtitle" data-i18n="market_subtitle">Balkan Region</div>
      </div>

      <div class="search-wrapper">
        <span class="search-icon">üîç</span>
        <input type="text" class="ios-input search-input" id="search-input" placeholder="" data-i18n-placeholder="search_ph">
      </div>

      <div class="grid-2" style="margin-bottom: 16px;">
        <div class="ios-input-group" style="margin:0;">
          <label class="ios-label" data-i18n="label_country">Land</label>
          <select class="ios-input" id="filter-country"></select>
        </div>
        <div class="ios-input-group" style="margin:0;">
          <label class="ios-label" data-i18n="label_category">Kategorie</label>
          <select class="ios-input" id="filter-cat"></select>
        </div>
      </div>

      <div class="grid-2">
        <div class="ios-input-group" style="margin:0;">
          <label class="ios-label" data-i18n="label_region">Region / Stadt</label>
          <input type="text" class="ios-input" placeholder="" data-i18n-placeholder="region_ph">
        </div>
        <div class="ios-input-group" style="margin:0;">
          <label class="ios-label" data-i18n="label_subcategory">Unterkategorie</label>
          <select class="ios-input" id="filter-sub" disabled>
            <option data-i18n="opt_all">Alle</option>
          </select>
        </div>
      </div>

      <div id="dynamic-filters" class="adv-filter-box"></div>

      <div class="listing-grid">
        <div class="empty-state">
          <div class="empty-icon">üè∑Ô∏è</div>
          <div data-i18n="empty_results">Keine Ergebnisse.<br><small>W√§hle Filter um Angebote zu sehen.</small></div>
        </div>
      </div>
    </section>

    <section id="view-sell" class="hidden">
      <div class="market-header">
        <div class="market-title" data-i18n="nav_sell">Verkaufen</div>
        <div class="market-subtitle" data-i18n="sell_subtitle">Erstelle ein neues Inserat</div>
      </div>

      <div class="ios-card">
        <div class="ios-label" style="margin-bottom:12px;" data-i18n="label_photos">Fotos (Max 8)</div>
        <div class="grid-4">
          <div class="upload-box main">üì∑</div>
          <div class="upload-box">+</div>
          <div class="upload-box">+</div>
          <div class="upload-box">+</div>
          <div class="upload-box">+</div>
          <div class="upload-box">+</div>
          <div class="upload-box">+</div>
          <div class="upload-box">+</div>
        </div>
      </div>

      <div class="ios-card">
        <div class="ios-input-group">
          <label class="ios-label" data-i18n="label_title">Titel</label>
          <input type="text" class="ios-input" placeholder="" data-i18n-placeholder="title_ph">
        </div>

        <div class="grid-2">
           <div class="ios-input-group">
            <label class="ios-label" data-i18n="label_country">Land</label>
            <select class="ios-input" id="sell-country"></select>
          </div>
          <div class="ios-input-group">
            <label class="ios-label" data-i18n="label_price">Preis (‚Ç¨)</label>
            <input type="number" class="ios-input" placeholder="0">
          </div>
        </div>

        <div class="grid-2">
          <div class="ios-input-group">
            <label class="ios-label" data-i18n="label_category">Kategorie</label>
            <select class="ios-input" id="sell-cat"></select>
          </div>
          <div class="ios-input-group">
            <label class="ios-label" data-i18n="label_subcategory">Unterkategorie</label>
            <select class="ios-input" id="sell-sub" disabled>
              <option data-i18n="opt_choose">W√§hlen...</option>
            </select>
          </div>
        </div>

        <div id="sell-dynamic-inputs" class="grid-2" style="margin-bottom: 20px; display:none;"></div>

        <div class="ios-input-group">
          <label class="ios-label" data-i18n="label_description">Beschreibung</label>
          <textarea class="ios-input" placeholder="" data-i18n-placeholder="desc_ph"></textarea>
        </div>

        <button class="ios-btn" data-i18n="btn_publish">Ver√∂ffentlichen</button>
      </div>
    </section>

    <section id="view-profile" class="hidden">
      <div class="profile-header">
        <div class="avatar-circle">üë§</div>
        <div class="market-title" style="font-size:24px;" data-i18n="profile_title">Mein Profil</div>
        <div class="market-subtitle" data-i18n="profile_subtitle">Gast</div>
      </div>

      <div class="list-group">
        <div class="list-item">
          <div style="display:flex; align-items:center;">
            <span class="list-icon">üë§</span> <span data-i18n="menu_personal">Pers√∂nliche Daten</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </div>
        <div class="list-item">
          <div style="display:flex; align-items:center;">
            <span class="list-icon">üì¶</span> <span data-i18n="menu_listings">Meine Inserate</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </div>
        <div class="list-item">
          <div style="display:flex; align-items:center;">
            <span class="list-icon">‚ù§Ô∏è</span> <span data-i18n="menu_watchlist">Merkliste</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </div>
      </div>

      <div class="list-group">
        <div class="list-item">
          <div style="display:flex; align-items:center;">
            <span class="list-icon">üîí</span> <span data-i18n="menu_security">Sicherheit</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </div>
      </div>

      <button class="ios-btn secondary" style="color:var(--danger);" data-i18n="btn_logout">Abmelden</button>
    </section>
  </main>

  <div class="tab-bar">
    <div class="tab-item active" id="tab-market" onclick="app.nav('market')">
      <div class="tab-icon">üîç</div><div class="tab-label" data-i18n="nav_market">Markt</div>
    </div>
    <div class="tab-item" id="tab-sell" onclick="app.nav('sell')">
      <div class="tab-icon">üì∑</div><div class="tab-label" data-i18n="nav_sell">Verkaufen</div>
    </div>
    <div class="tab-item" id="tab-profile" onclick="app.nav('profile')">
      <div class="tab-icon">üë§</div><div class="tab-label" data-i18n="nav_profile">Profil</div>
    </div>
  </div>

  <script>
    // --- TRANSLATION DATABASE ---
    const TRANSLATIONS = {
      de: {
        nav_market: "Entdecken", nav_sell: "Verkaufen", nav_profile: "Profil",
        market_title: "Marktplatz", market_subtitle: "Balkan Region",
        sell_subtitle: "Erstelle ein neues Inserat",
        profile_title: "Mein Profil", profile_subtitle: "Gast",
        search_ph: "Suche (z.B. Golf 7, Wohnung)...",
        label_country: "Land", label_category: "Kategorie", label_region: "Region / Stadt",
        label_subcategory: "Unterkategorie", label_title: "Titel", label_price: "Preis (‚Ç¨)",
        label_description: "Beschreibung", label_photos: "Fotos (Max 8)",
        region_ph: "Ort eingeben", title_ph: "Was verkaufst du?", desc_ph: "Details zum Artikel...",
        btn_publish: "Ver√∂ffentlichen", btn_logout: "Abmelden",
        opt_all: "Alle", opt_choose: "W√§hlen...",
        menu_personal: "Pers√∂nliche Daten", menu_listings: "Meine Inserate", 
        menu_watchlist: "Merkliste", menu_security: "Sicherheit",
        empty_results: "Keine Ergebnisse.<br><small>W√§hle Filter um Angebote zu sehen.</small>",
        // Context Filters
        filter_km: "Kilometer bis", filter_year: "Erstzulassung ab",
        filter_area: "Fl√§che (m¬≤)", filter_rooms: "Zimmer ab"
      },
      en: {
        nav_market: "Discover", nav_sell: "Sell", nav_profile: "Profile",
        market_title: "Marketplace", market_subtitle: "Balkan Region",
        sell_subtitle: "Create a new listing",
        profile_title: "My Profile", profile_subtitle: "Guest",
        search_ph: "Search (e.g. Golf 7, Apartment)...",
        label_country: "Country", label_category: "Category", label_region: "Region / City",
        label_subcategory: "Subcategory", label_title: "Title", label_price: "Price (‚Ç¨)",
        label_description: "Description", label_photos: "Photos (Max 8)",
        region_ph: "Enter location", title_ph: "What are you selling?", desc_ph: "Item details...",
        btn_publish: "Publish", btn_logout: "Log out",
        opt_all: "All", opt_choose: "Choose...",
        menu_personal: "Personal Data", menu_listings: "My Listings", 
        menu_watchlist: "Watchlist", menu_security: "Security",
        empty_results: "No results.<br><small>Choose filters to see listings.</small>",
        filter_km: "Max Mileage", filter_year: "Min Year",
        filter_area: "Min Area (m¬≤)", filter_rooms: "Min Rooms"
      },
      sq: { // Albanian
        nav_market: "Zbulo", nav_sell: "Shit", nav_profile: "Profili",
        market_title: "Tregu", market_subtitle: "Rajoni i Ballkanit",
        sell_subtitle: "Krijo nj√´ njoftim t√´ ri",
        profile_title: "Profili Im", profile_subtitle: "Mysafir",
        search_ph: "K√´rko (p.sh. Golf 7, Banes√´)...",
        label_country: "Shteti", label_category: "Kategoria", label_region: "Rajoni / Qyteti",
        label_subcategory: "N√´nkategoria", label_title: "Titulli", label_price: "√ámimi (‚Ç¨)",
        label_description: "P√´rshkrimi", label_photos: "Fotot (Max 8)",
        region_ph: "Shkruaj vendndodhjen", title_ph: "√áfar√´ po shet?", desc_ph: "Detajet e artikullit...",
        btn_publish: "Publiko", btn_logout: "Dil",
        opt_all: "T√´ gjitha", opt_choose: "Zgjidh...",
        menu_personal: "T√´ dh√´nat personale", menu_listings: "Njoftimet e mia", 
        menu_watchlist: "Lista e d√´shirave", menu_security: "Siguria",
        empty_results: "Asnj√´ rezultat.<br><small>Zgjidhni filt√´r p√´r t√´ par√´ ofertat.</small>",
        filter_km: "Kilometra deri", filter_year: "Viti nga",
        filter_area: "Sip√´rfaqja (m¬≤)", filter_rooms: "Dhoma nga"
      },
      sr: { // Serbian/Bosnian/Croatian (Latin)
        nav_market: "Otkrij", nav_sell: "Prodaj", nav_profile: "Profil",
        market_title: "Pijaca", market_subtitle: "Balkanski Region",
        sell_subtitle: "Kreiraj novi oglas",
        profile_title: "Moj Profil", profile_subtitle: "Gost",
        search_ph: "Pretra≈æi (npr. Golf 7, Stan)...",
        label_country: "Dr≈æava", label_category: "Kategorija", label_region: "Region / Grad",
        label_subcategory: "Podkategorija", label_title: "Naslov", label_price: "Cena (‚Ç¨)",
        label_description: "Opis", label_photos: "Slike (Max 8)",
        region_ph: "Unesi lokaciju", title_ph: "≈†ta prodaje≈°?", desc_ph: "Detalji artikla...",
        btn_publish: "Objavi", btn_logout: "Odjavi se",
        opt_all: "Sve", opt_choose: "Izaberi...",
        menu_personal: "Liƒçni podaci", menu_listings: "Moji oglasi", 
        menu_watchlist: "Lista ≈æelja", menu_security: "Sigurnost",
        empty_results: "Nema rezultata.<br><small>Izaberi filtere za prikaz ponuda.</small>",
        filter_km: "Kilometra≈æa do", filter_year: "Godi≈°te od",
        filter_area: "Povr≈°ina (m¬≤)", filter_rooms: "Soba od"
      },
      mk: { // Macedonian
        nav_market: "–û—Ç–∫—Ä–∏—ò", nav_sell: "–ü—Ä–æ–¥–∞—ò", nav_profile: "–ü—Ä–æ—Ñ–∏–ª",
        market_title: "–ü–∞–∑–∞—Ä", market_subtitle: "–ë–∞–ª–∫–∞–Ω—Å–∫–∏ —Ä–µ–≥–∏–æ–Ω",
        sell_subtitle: "–ö—Ä–µ–∏—Ä–∞—ò –Ω–æ–≤ –æ–≥–ª–∞—Å",
        profile_title: "–ú–æ—ò –ü—Ä–æ—Ñ–∏–ª", profile_subtitle: "–ì–æ—Å—Ç–∏–Ω",
        search_ph: "–ë–∞—Ä–∞—ò (–Ω–ø—Ä. Golf 7, –°—Ç–∞–Ω)...",
        label_country: "–î—Ä–∂–∞–≤–∞", label_category: "–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞", label_region: "–†–µ–≥–∏–æ–Ω / –ì—Ä–∞–¥",
        label_subcategory: "–ü–æ—Ç–∫–∞—Ç–µ–≥–æ—Ä–∏—ò–∞", label_title: "–ù–∞—Å–ª–æ–≤", label_price: "–¶–µ–Ω–∞ (‚Ç¨)",
        label_description: "–û–ø–∏—Å", label_photos: "–°–ª–∏–∫–∏ (Max 8)",
        region_ph: "–í–Ω–µ—Å–∏ –ª–æ–∫–∞—Ü–∏—ò–∞", title_ph: "–®—Ç–æ –ø—Ä–æ–¥–∞–≤–∞—à?", desc_ph: "–î–µ—Ç–∞–ª–∏ –∑–∞ –∞—Ä—Ç–∏–∫–ª–æ—Ç...",
        btn_publish: "–û–±—ò–∞–≤–∏", btn_logout: "–û–¥—ò–∞–≤–∏ —Å–µ",
        opt_all: "–°–∏—Ç–µ", opt_choose: "–ò–∑–±–µ—Ä–∏...",
        menu_personal: "–õ–∏—á–Ω–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏", menu_listings: "–ú–æ–∏ –æ–≥–ª–∞—Å–∏", 
        menu_watchlist: "–õ–∏—Å—Ç–∞ –Ω–∞ –∂–µ–ª–±–∏", menu_security: "–ë–µ–∑–±–µ–¥–Ω–æ—Å—Ç",
        empty_results: "–ù–µ–º–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏.<br><small>–ò–∑–±–µ—Ä–∏ —Ñ–∏–ª—Ç—Ä–∏ –∑–∞ –¥–∞ –≤–∏–¥–∏—à –ø–æ–Ω—É–¥–∏.</small>",
        filter_km: "–ö–∏–ª–æ–º–µ—Ç—Ä–∏ –¥–æ", filter_year: "–ì–æ–¥–∏–Ω–∞ –æ–¥",
        filter_area: "–ü–æ–≤—Ä—à–∏–Ω–∞ (m¬≤)", filter_rooms: "–°–æ–±–∏ –æ–¥"
      }
    };

    // --- DATA CONFIGURATION (Translated Keys) ---
    const COUNTRIES_DATA = {
      all: { de: "Alle / Egal", en: "All / Any", sq: "T√´ gjitha / Kudo", sr: "Sve / Bilo gde", mk: "–°–∏—Ç–µ" },
      al: { de: "Albanien", en: "Albania", sq: "Shqip√´ria", sr: "Albanija", mk: "–ê–ª–±–∞–Ω–∏—ò–∞" },
      ba: { de: "Bosnien & Herz.", en: "Bosnia & Herz.", sq: "Bosnja dhe H.", sr: "Bosna i Herc.", mk: "–ë–æ—Å–Ω–∞ –∏ –•–µ—Ä—Ü." },
      bg: { de: "Bulgarien", en: "Bulgaria", sq: "Bullgaria", sr: "Bugarska", mk: "–ë—É–≥–∞—Ä–∏—ò–∞" },
      gr: { de: "Griechenland", en: "Greece", sq: "Greqia", sr: "Grƒçka", mk: "–ì—Ä—Ü–∏—ò–∞" },
      xk: { de: "Kosovo", en: "Kosovo", sq: "Kosova", sr: "Kosovo", mk: "–ö–æ—Å–æ–≤–æ" },
      hr: { de: "Kroatien", en: "Croatia", sq: "Kroacia", sr: "Hrvatska", mk: "–•—Ä–≤–∞—Ç—Å–∫–∞" },
      me: { de: "Montenegro", en: "Montenegro", sq: "Mali i Zi", sr: "Crna Gora", mk: "–¶—Ä–Ω–∞ –ì–æ—Ä–∞" },
      mk: { de: "Nordmazedonien", en: "North Macedonia", sq: "Maqedonia e Veriut", sr: "Severna Makedonija", mk: "–°–µ–≤–µ—Ä–Ω–∞ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞" },
      rs: { de: "Serbien", en: "Serbia", sq: "Serbia", sr: "Srbija", mk: "–°—Ä–±–∏—ò–∞" },
      si: { de: "Slowenien", en: "Slovenia", sq: "Sllovenia", sr: "Slovenija", mk: "–°–ª–æ–≤–µ–Ω–∏—ò–∞" },
      tr: { de: "T√ºrkei", en: "Turkey", sq: "Turqia", sr: "Turska", mk: "–¢—É—Ä—Ü–∏—ò–∞" }
    };

    const CATEGORIES_DATA = {
      vehicles: {
        label: { de: "Fahrzeuge", en: "Vehicles", sq: "Automjete", sr: "Vozila", mk: "–í–æ–∑–∏–ª–∞" },
        subs: [
          { k: "small", de: "Kleinwagen", en: "Small Car", sq: "Vetur√´ e vog√´l", sr: "Mali auto", mk: "–ú–∞–ª –∞–≤—Ç–æ–º–æ–±–∏–ª" },
          { k: "limo", de: "Limousine", en: "Sedan", sq: "Limuzin√´", sr: "Limuzina", mk: "–õ–∏–º—É–∑–∏–Ω–∞" },
          { k: "wagon", de: "Kombi", en: "Wagon", sq: "Karavan", sr: "Karavan", mk: "–ö–∞—Ä–∞–≤–∞–Ω" },
          { k: "suv", de: "SUV / Gel√§ndewagen", en: "SUV / Offroad", sq: "SUV / Fuoristrad√´", sr: "SUV / Terenac", mk: "SUV / –¢–µ—Ä–µ–Ω–µ—Ü" },
          { k: "moto", de: "Motorrad", en: "Motorcycle", sq: "Moto√ßiklet√´", sr: "Motocikl", mk: "–ú–æ—Ç–æ—Ü–∏–∫–ª" },
          { k: "truck", de: "Nutzfahrzeug", en: "Truck/Van", sq: "Kamion/Furgon", sr: "Teretno vozilo", mk: "–¢–æ–≤–∞—Ä–Ω–æ –≤–æ–∑–∏–ª–æ" }
        ],
        filters: [ { id: "filter_km" }, { id: "filter_year" } ]
      },
      realestate: {
        label: { de: "Immobilien", en: "Real Estate", sq: "Patundshm√´ri", sr: "Nekretnine", mk: "–ù–µ–¥–≤–∏–∂–Ω–æ—Å—Ç–∏" },
        subs: [
          { k: "apt_buy", de: "Wohnung (Kauf)", en: "Apartment (Buy)", sq: "Banes√´ (Blerje)", sr: "Stan (Prodaja)", mk: "–°—Ç–∞–Ω (–ü—Ä–æ–¥–∞–∂–±–∞)" },
          { k: "apt_rent", de: "Wohnung (Miete)", en: "Apartment (Rent)", sq: "Banes√´ (Qira)", sr: "Stan (Izdavanje)", mk: "–°—Ç–∞–Ω (–ò–∑–Ω–∞—ò–º—É–≤–∞—ö–µ)" },
          { k: "house_buy", de: "Haus (Kauf)", en: "House (Buy)", sq: "Sht√´pi (Blerje)", sr: "Kuƒáa (Prodaja)", mk: "–ö—É—ú–∞ (–ü—Ä–æ–¥–∞–∂–±–∞)" },
          { k: "land", de: "Grundst√ºck", en: "Land", sq: "Truall", sr: "Zemlji≈°te", mk: "–ó–µ–º—ò–∏—à—Ç–µ" },
          { k: "comm", de: "Gewerbe", en: "Commercial", sq: "Hap√´sir√´ afariste", sr: "Poslovni prostor", mk: "–î–µ–ª–æ–≤–µ–Ω –ø—Ä–æ—Å—Ç–æ—Ä" }
        ],
        filters: [ { id: "filter_area" }, { id: "filter_rooms" } ]
      },
      electronics: {
        label: { de: "Elektronik", en: "Electronics", sq: "Elektronik√´", sr: "Elektronika", mk: "–ï–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞" },
        subs: [
          { k: "phone", de: "Smartphone", en: "Smartphone", sq: "Telefon", sr: "Telefon", mk: "–¢–µ–ª–µ—Ñ–æ–Ω" },
          { k: "laptop", de: "Laptop / PC", en: "Laptop / PC", sq: "Laptop / PC", sr: "Laptop / Raƒçunar", mk: "–õ–∞–ø—Ç–æ–ø / –ö–æ–º–ø—ò—É—Ç–µ—Ä" },
          { k: "console", de: "Konsole", en: "Console", sq: "Konzol√´", sr: "Konzola", mk: "–ö–æ–Ω–∑–æ–ª–∞" },
          { k: "tv", de: "TV & Audio", en: "TV & Audio", sq: "TV & Audio", sr: "TV & Audio", mk: "–¢–í –∏ –ê—É–¥–∏–æ" }
        ],
        filters: []
      },
      fashion: {
        label: { de: "Mode", en: "Fashion", sq: "Moda", sr: "Moda", mk: "–ú–æ–¥–∞" },
        subs: [
          { k: "women", de: "Damen", en: "Women", sq: "Femra", sr: "≈Ωene", mk: "–ñ–µ–Ω–∏" },
          { k: "men", de: "Herren", en: "Men", sq: "Meshkuj", sr: "Mu≈°karci", mk: "–ú–∞–∂–∏" },
          { k: "kids", de: "Kinder", en: "Kids", sq: "F√´mij√´", sr: "Deca", mk: "–î–µ—Ü–∞" }
        ],
        filters: []
      },
      services: {
        label: { de: "Dienstleistung", en: "Services", sq: "Sh√´rbime", sr: "Usluge", mk: "–£—Å–ª—É–≥–∏" },
        subs: [
          { k: "craft", de: "Handwerk", en: "Crafts", sq: "Zejtari", sr: "Zanatstvo", mk: "–ó–∞–Ω–∞–µ—Ç—á–∏—Å—Ç–≤–æ" },
          { k: "trans", de: "Transport", en: "Transport", sq: "Transport", sr: "Transport", mk: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç" },
          { k: "tech", de: "IT & Tech", en: "IT & Tech", sq: "IT & Tech", sr: "IT & Tech", mk: "–ò–¢ –∏ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—ò–∞" }
        ],
        filters: []
      }
    };

    // --- APP LOGIC ---
    const app = {
      lang: 'de',

      init: () => {
        app.loadTheme();
        // Set default language or load from storage logic could go here
        app.setLanguage('de'); 
        app.setupListeners('filter');
        app.setupListeners('sell');
      },

      setLanguage: (langCode) => {
        app.lang = langCode;
        app.translatePage();
        // Re-populate dropdowns to reflect language change
        app.populateDropdowns('filter');
        app.populateDropdowns('sell');
        // Reset sub dropdowns
        document.getElementById('filter-sub').innerHTML = `<option>${TRANSLATIONS[langCode].opt_all}</option>`;
        document.getElementById('filter-sub').disabled = true;
        document.getElementById('sell-sub').innerHTML = `<option>${TRANSLATIONS[langCode].opt_choose}</option>`;
        document.getElementById('sell-sub').disabled = true;
      },

      translatePage: () => {
        const t = TRANSLATIONS[app.lang];
        
        // Translate text content
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          if (t[key]) el.innerHTML = t[key];
        });

        // Translate placeholders
        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
          const key = el.getAttribute('data-i18n-placeholder');
          if (t[key]) el.placeholder = t[key];
        });
      },

      populateDropdowns: (prefix) => {
        const lang = app.lang;
        
        // Countries
        const countrySel = document.getElementById(prefix + '-country');
        countrySel.innerHTML = "";
        for (const code in COUNTRIES_DATA) {
          const opt = document.createElement('option');
          opt.value = code; 
          opt.textContent = COUNTRIES_DATA[code][lang] || COUNTRIES_DATA[code]['en'];
          countrySel.appendChild(opt);
        }

        // Categories
        const catSel = document.getElementById(prefix + '-cat');
        const currentVal = catSel.value; // Remember selection if possible
        catSel.innerHTML = "";
        
        const defOpt = document.createElement('option');
        defOpt.value = ""; 
        defOpt.textContent = prefix === 'filter' ? TRANSLATIONS[lang].opt_all : TRANSLATIONS[lang].opt_choose;
        catSel.appendChild(defOpt);

        for (const catKey in CATEGORIES_DATA) {
          const opt = document.createElement('option');
          opt.value = catKey;
          opt.textContent = CATEGORIES_DATA[catKey].label[lang];
          catSel.appendChild(opt);
        }
        catSel.value = currentVal; // Restore selection if valid
      },

      setupListeners: (prefix) => {
        const catSel = document.getElementById(prefix + '-cat');
        const subSel = document.getElementById(prefix + '-sub');
        
        catSel.addEventListener('change', () => {
          const val = catSel.value;
          const lang = app.lang;
          subSel.innerHTML = ""; 

          const def = document.createElement('option');
          def.textContent = prefix === 'filter' ? TRANSLATIONS[lang].opt_all : TRANSLATIONS[lang].opt_choose;
          subSel.appendChild(def);

          if (val && CATEGORIES_DATA[val]) {
            subSel.disabled = false;
            CATEGORIES_DATA[val].subs.forEach(item => {
              const opt = document.createElement('option');
              opt.value = item.k; 
              opt.textContent = item[lang];
              subSel.appendChild(opt);
            });
            app.renderContextFilters(prefix, val);
          } else {
            subSel.disabled = true;
            app.renderContextFilters(prefix, null);
          }
        });
      },

      renderContextFilters: (prefix, categoryKey) => {
        const containerId = prefix === 'filter' ? 'dynamic-filters' : 'sell-dynamic-inputs';
        const container = document.getElementById(containerId);
        container.innerHTML = "";
        container.style.display = "none";
        container.classList.remove('show');

        if (!categoryKey || !CATEGORIES_DATA[categoryKey].filters.length) return;

        const filters = CATEGORIES_DATA[categoryKey].filters;
        const lang = app.lang;
        const t = TRANSLATIONS[lang];

        if (prefix === 'filter') {
          container.style.display = "block";
          setTimeout(() => container.classList.add('show'), 10);
          let html = '<div class="grid-2">';
          filters.forEach(f => {
            const label = t[f.id] || f.id;
            html += `
              <div class="ios-input-group" style="margin:0">
                <label class="ios-label">${label}</label>
                <input type="number" class="ios-input" placeholder="0">
              </div>`;
          });
          html += '</div>';
          container.innerHTML = html;
        } else {
          container.style.display = "grid";
          filters.forEach(f => {
            const label = t[f.id] || f.id;
            const div = document.createElement('div');
            div.className = "ios-input-group";
            div.innerHTML = `
              <label class="ios-label">${label}</label>
              <input type="number" class="ios-input" placeholder="0">
            `;
            container.appendChild(div);
          });
        }
      },

      loadTheme: () => {
        const saved = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', saved);
        document.getElementById('theme-icon').textContent = saved === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      },

      nav: (view) => {
        window.scrollTo(0,0);
        ['market', 'sell', 'profile'].forEach(v => {
          document.getElementById('view-' + v).classList.add('hidden');
          document.getElementById('tab-' + v).classList.remove('active');
          const d = document.getElementById('d-' + v);
          if(d) d.classList.remove('active');
        });
        document.getElementById('view-' + view).classList.remove('hidden');
        document.getElementById('tab-' + view).classList.add('active');
        const activeD = document.getElementById('d-' + view);
        if(activeD) activeD.classList.add('active');
      },

      toggleTheme: () => {
        const current = document.documentElement.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        document.getElementById('theme-icon').textContent = next === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      }
    };

    app.init();
  </script>
</body>
</html>
